pipeline {
    agent any

    options {
          timeout(time: 240, unit: 'MINUTES')
    }

    stages {
        stage('Checkout') {
            steps {
               checkout scm
            }
        }
		stage('Build and push containers') {
			steps {
			    withEnv(["GITHUB_TOKEN="+STORJ_UP_IMAGE_UPLOAD]) {
			        sh "go install github.com/magefile/mage@latest"
				    sh "mage -v images"
				}
			}
		}
    }
}
