pipeline {
    agent any

    options {
          timeout(time: 240, unit: 'MINUTES')
    }

    stages {
        stage('Checkout') {
            steps {
               checkout scm
            }
        }
		stage('Build and push containers') {
			steps {
			    withCredentials([string(credentialsId: 'github-ghcr-elek-storjup', variable: 'GITHUB_TOKEN')]) {
			        sh "go install github.com/magefile/mage@latest"
				    sh "mage -v images"
				}
			}
		}
    }
}
